#| Edward Flick
   Software Engineering I
   iEx5_test

   Tests for the iEx5 assignment.
|#

(in-package "ACL2")
(include-book "testing" :dir :teachpacks)
(include-book "doublecheck" :dir :teachpacks)
(include-book "iEx5")
;(include-book "stringutils")

; stringlist-append (stringlist)
(check-expect (stringlist-append nil) "")
(check-expect (stringlist-append '("zyxel")) "zyxel")
(check-expect (stringlist-append '("zyxel" "quijibo")) "zyxelquijibo")
(check-expect (stringlist-append '("man" "da" "rin")) "mandarin")

; getboards (xmlnode)
(check-expect (getboards nil) "")
(check-expect
 (getboards
  (list
   (mv
    "Game"
    nil
    (list
     (mv "Vulnerable" nil (list (mv 'text nil "NS")))
     (mv "Dealer" nil (list (mv 'text nil "N")))
     (mv "Deal" nil
         (list
          (mv 
           "Hand"
           (list (mv "direction" "N"))
           (list
            (mv "Suit"
                (list (mv "symbol" "S"))
                (list (mv 'text nil "234")))
            ))
          )))))
  )
 (stringlist-append (list
  "<div class=\"board\">"
  "<div class=\"N\">"
  "<div class=\"dealer\">Dealer</div>"
  "<div class=\"vulnerable\">Vulnerable</div>"
  "&spades;234<br />"
  "</div>"  
  "</div>")))
(check-expect
 (getboards
  (list
   (mv
    "Game"
    nil
    (list
     (mv "Vulnerable" nil (list (mv 'text nil "None")))
     (mv "Dealer" nil (list (mv 'text nil "E")))
     (mv "Deal" nil
         (list
          (mv 
           "Hand"
           (list (mv "direction" "N"))
           (list
            (mv "Suit"
                (list (mv "symbol" "S"))
                (list (mv 'text nil "234")))
            ))
          (mv 
           "Hand"
           (list (mv "direction" "W"))
           (list
            (mv "Suit"
                (list (mv "symbol" "C"))
                (list (mv 'text nil "234")))
            ))
          )))))
  )
 (stringlist-append (list
  "<div class=\"board\">"
  "<div class=\"N\">"
  "&spades;234<br />"
  "</div>"  
  "<div class=\"W\">"
  "&clubs;234<br />"
  "</div>"  
  "</div>")))
               

; gethands (xmlnodes vulnerable dealer)
(check-expect (gethands nil "Both" "N") "")
(check-expect 
 (gethands 
  (list
   (mv 
    "Hand"
    (list (mv "direction" "N"))
    (list
     (mv "Suit"
         (list (mv "symbol" "S"))
         (list (mv 'text nil "234")))
     ))
   )
  "NS" "N") 
 (stringlist-append (list "<div class=\"N\">"
                "<div class=\"dealer\">Dealer</div>"
                "<div class=\"vulnerable\">Vulnerable</div>"
                "&spades;234<br />"
                "</div>")))
(check-expect 
 (gethands 
  (list
   (mv 
    "Hand"
    (list (mv "direction" "N"))
    (list
     (mv "Suit"
         (list (mv "symbol" "S"))
         (list (mv 'text nil "234")))
     ))
   )
  "NS" "E") 
 (stringlist-append (list "<div class=\"N\">"
                "<div class=\"vulnerable\">Vulnerable</div>"
                "&spades;234<br />"
                "</div>")))
(check-expect 
 (gethands 
  (list
   (mv 
    "Hand"
    (list (mv "direction" "N"))
    (list
     (mv "Suit"
         (list (mv "symbol" "S"))
         (list (mv 'text nil "234")))
     ))
   )
  "Both" "N") 
 (stringlist-append (list "<div class=\"N\">"
                "<div class=\"dealer\">Dealer</div>"
                "<div class=\"vulnerable\">Vulnerable</div>"
                "&spades;234<br />"
                "</div>")))
(check-expect 
 (gethands 
  (list
   (mv 
    "Hand"
    (list (mv "direction" "W"))
    (list
     (mv "Suit"
         (list (mv "symbol" "S"))
         (list (mv 'text nil "234")))
     ))
   )
  "None" "N") 
 (stringlist-append (list "<div class=\"W\">"
                "&spades;234<br />"
                "</div>")))

               
; gethandcards (xmlnodes)
(check-expect 
 (gethandcards nil)
 "")
(check-expect 
 (gethandcards (list
                (mv "Suit"
                    (list (mv "symbol" "S"))
                    (list (mv 'text nil "234")))
                (mv "Suit"
                    (list (mv "symbol" "C"))
                    (list (mv 'text nil "567")))))
 "&spades;234<br />&clubs;567<br />")
(check-expect 
 (gethandcards (list
                (mv "Suit"
                    (list (mv "symbol" "D"))
                    (list (mv 'text nil "89T")))
                (mv "Suit"
                    (list (mv "symbol" "H"))
                    (list (mv 'text nil "JQKA")))))
 "&diams;89T<br />&hearts;JQKA<br />")
